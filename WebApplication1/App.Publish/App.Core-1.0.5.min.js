var __extends,App;(function(n){var r=function(){function t(n,t,i){this.authService=n;this.stateService=t;this.rootScopeService=i;var r=this.authService.AccountInfo;r&&r.IsAuth&&this.stateService.go("root.home")}return t.prototype.Signin=function(){var t=this,i=function(){t.stateService.go("root.home");t.rootScopeService.$broadcast("SignedIn")},r=function(n){console.log(n);n.data.error_description?alert(n.data.error_description):alert("Unknown error occurred. Please contact support. Thanks.");t.ShowErrorMessage=!0};t.authService.Signin(new n.SigninRequest(t.User.Email,t.User.Password)).then(i,r)},t.$inject=["AuthService","$state","$rootScope"],t}(),t,i;n.SigninController=r;angular.module("app").controller("SigninController",r);t=function(){function n(n,t,i){var r=this,u;r.authService=n;r.stateService=t;r.rootScopeService=i;u=r.authService.AccountInfo;u&&u.IsAuth?r.loadUser():r.IsSignedIn=!1;r.rootScopeService.$on("SignedIn",function(){r.loadUser()})}return n.prototype.loadUser=function(){var n=this;n.User=this.authService.AccountInfo;n.IsSignedIn=this.authService.IsSignedIn()},n.prototype.Signout=function(){var n=this;n.authService.Signout();n.loadUser();n.stateService.go("root.signin");n.rootScopeService.$broadcast("SignedOut")},n.$inject=["AuthService","$state","$rootScope"],n}();n.NavController=t;angular.module("app").controller("NavController",t);i=function(){function t(t,i){this.authService=t;this.stateService=i;var r=this.authService.AccountInfo;r&&r.IsAuth&&this.stateService.go("root.home");this.Notification=new n.Notification;this.Notification.IsError=!1;this.Notification.IsInfo=!1;this.IsDisabled=!1}return t.prototype.Register=function(){var n=this,t,i;n.IsDisabled=!0;t=function(t){return n.stateService.go("root.signin"),n.IsDisabled=!1,t};i=function(t){n.IsDisabled=!1;console.log(t);n.Notification.IsError=!0;n.Notification.Message=t.status===500?t.data.ExceptionMessage:t.status===400&&t.data.ModelState["model.Password"]?t.data.ModelState["model.Password"][0]:t.status===400&&t.data.ModelState["model.Phone"]?t.data.ModelState["model.Phone"][0]:t.status===400&&t.data.ModelState[""]?t.data.ModelState[""].length>1?t.data.ModelState[""][1]:t.data.ModelState[""][0]:t.data.Message};n.authService.Register(n.User).then(t,i)},t.$inject=["AuthService","$state"],t}();n.RegisterController=i;angular.module("app").controller("RegisterController",i)})(App||(App={})),function(n){"use strict";var t=function(){function n(n,t,i){this.Q=n;this.Url=t;this.Web=i}return n}();n.BaseService=t}(App||(App={})),function(n){var t=function(){function n(n,t){this.qService=n;this.httpService=t}return n.prototype.Post=function(n,t){var r=this,i=r.qService.defer();return r.httpService.post(n,t).then(function(n){n.status===200?i.resolve(n):i.reject(n)},function(n){i.reject(n)}),i.promise},n.prototype.Put=function(n,t){var r=this,i=r.qService.defer();return r.httpService.put(n,t).then(function(n){n.status===200?i.resolve(n):i.reject(n)},function(n){i.reject(n)}),i.promise},n.prototype.PostUrlencodedForm=function(n,t){var r=this,i=r.qService.defer();return r.httpService.post(n,t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(n){n.status===200?i.resolve(n):i.reject(n)},function(n){i.reject(n)}),i.promise},n.prototype.Get=function(n){var i=this,t=i.qService.defer();return i.httpService.get(n).then(function(n){n.status===200?t.resolve(n):t.reject(n)},function(n){t.reject(n)}),t.promise},n.prototype.Delete=function(n){var i=this,t=i.qService.defer();return i.httpService.delete(n).then(function(n){n.status===200?t.resolve(n):t.reject(n)},function(n){t.reject(n)}),t.promise},n.$inject=["$q","$http"],n}();n.WebService=t;angular.module("app").service("WebService",t)}(App||(App={})),function(n){"use strict";var t=function(){function n(){var t="",n;t="/ShoppersZone";n=t+"/api";this.BaseUrl=t;this.SigninUrl=t+"/token";this.PermissionUrl=n+"/Permission";this.RegisterUrl=n+"/Account/Register";this.SideMenuUrl=n+"/SideMenu";this.ProfileUrl=n+"/Account/GetUserInfo";this.ChangePasswordUrl=n+"/Account/ChangePassword";this.BarcodeImage=n+"/BarcodeImage";this.productQuery=n+"/ProductQuery";this.ProductQueryBarcode=this.productQuery+"/Barcode";this.ProductQueryData=this.productQuery+"/Data";this.ProductQueryCount=this.productQuery+"/Count";this.ProductQueryReport=this.productQuery+"/Report";this.Product=n+"/Product";this.SupplierQuery=n+"/SupplierQuery";this.Supplier=n+"/Supplier";this.SupplierQueryData=this.SupplierQuery+"/Data";this.SupplierQueryCount=this.SupplierQuery+"/Count";this.SupplierQueryReport=this.SupplierQuery+"/Report";this.SupplierHistoryQuery=n+"/SupplierHistoryQuery";this.Purchase=n+"/Purchase";this.PurchaseQuery=n+"/PurchaseQuery";this.PurchaseQueryData=this.PurchaseQuery+"/Data";this.PurchaseQueryCount=this.PurchaseQuery+"/Count";this.PurchaseQueryReport=this.PurchaseQuery+"/Report";this.PurchaseDetail=n+"/PurchaseDetail";this.PurchaseDetailQuery=n+"/PurchaseDetailQuery";this.Payment=n+"/Payment";this.PaymentQuery=n+"/PaymentQuery";this.PaymentQueryData=this.PaymentQuery+"/Data";this.PaymentQueryCount=this.PaymentQuery+"/Count";this.PaymentQueryReport=this.PaymentQuery+"/Report";this.Dropdown=n+"/Dropdown";this.Sale=n+"/Sale";this.saleQuery=n+"/SaleQuery";this.SaleQueryData=this.saleQuery+"/Data";this.SaleQueryCount=this.saleQuery+"/Count";this.SaleQueryReport=this.saleQuery+"/Report";this.SaleDetail=n+"/SaleDetail";this.SaleDetailQuery=n+"/SaleDetailQuery";this.Bookmark=n+"/Bookmark";this.BookmarkQuery=n+"/BookmarkQuery";this.BookmarkQueryData=this.BookmarkQuery+"/Data";this.BookmarkQueryCount=this.BookmarkQuery+"/Count";this.ProductBookmark=n+"/ProductBookmark";this.ProductBookmarkQuery=n+"/ProductBookmarkQuery";this.ProductBookmarkQueryData=this.ProductBookmarkQuery+"/Data";this.ProductBookmarkQueryCount=this.ProductBookmarkQuery+"/Count";this.StockQuery=n+"/StockQuery";this.StockQueryData=this.StockQuery+"/Data";this.StockQueryCount=this.StockQuery+"/Count";this.CustomerQuery=n+"/CustomerQuery";this.Customer=n+"/Customer";this.CustomerQueryBarcode=this.CustomerQuery+"/Barcode";this.CustomerQueryData=this.CustomerQuery+"/Data";this.CustomerQueryCount=this.CustomerQuery+"/Count";this.CustomerQueryReport=this.CustomerQuery+"/Report";this.CustomerHistoryQuery=n+"/CustomerHistoryQuery"}return n}();n.UrlService=t;angular.module("app").service("UrlService",t)}(App||(App={})),function(n){"use strict";var t=function(){function t(n,t,i,r){this.Q=n;this.Url=t;this.Web=i;this.Auth=r}return t.prototype.Save=function(t,i){var r=this,u=r.Q.defer();return t.Created=(new Date).toDateString(),t.Modified=(new Date).toDateString(),t.CreatedBy=r.Auth.AccountInfo.UserName,t.ModifiedBy=r.Auth.AccountInfo.UserName,r.Web.Post(i,t).then(function(t){var i=new n.BaseResponse(!0,t.data,"Success");u.resolve(i)},function(n){u.reject(n)}),u.promise},t.prototype.Update=function(t,i){var r=this,u=r.Q.defer();return t.Modified=(new Date).toDateString(),t.ModifiedBy=r.Auth.AccountInfo.UserName,r.Web.Put(i,t).then(function(t){var i=new n.BaseResponse(!0,t.data,"Success");u.resolve(i)},function(n){u.reject(n)}),u.promise},t.prototype.Delete=function(t,i){var u=this,r=u.Q.defer();return u.Web.Delete(i+"?id="+t).then(function(t){var i=new n.BaseResponse(!0,t.data,"Success");r.resolve(i)},function(n){r.reject(n)}),r.promise},t.$inject=["$q","UrlService","WebService","AuthService"],t}();n.SaveService=t;angular.module("app").service("SaveService",t)}(App||(App={})),function(n){"use strict";var t=function(){function t(n,t,i){this.Q=n;this.Url=t;this.Web=i;this.Id=undefined}return t.prototype.Search=function(t,i){var u=this,r=u.Q.defer();return u.Web.Post(i,t).then(function(t){var i=new n.SearchResponse(t.data);r.resolve(i)},function(n){r.reject(n)}),r.promise},t.prototype.Get=function(n){var i=this,t=i.Q.defer();return i.Web.Get(n).then(function(n){var i=n.data;t.resolve(i)},function(n){t.reject(n)}),t.promise},t.prototype.Download=function(n){var i=this,t=i.Q.defer();return i.Web.Get(n).then(function(n){t.resolve(n)},function(n){t.reject(n)}),t.promise},t.$inject=["$q","UrlService","WebService"],t}();n.SearchService=t;angular.module("app").service("SearchService",t)}(App||(App={})),function(n){"use strict";var t=function(){function t(n,t,i){this.Q=n;this.Url=t;this.Web=i}return t.prototype.Load=function(t){var i=this,r=i.Q.defer(),u=i.Url.Dropdown+"?name="+t;return i.Web.Get(u).then(function(t){var i=new n.SearchResponse(t.data);r.resolve(i)},function(n){r.reject(n)}),r.promise},t.$inject=["$q","UrlService","WebService"],t}(),i;n.DropdownService=t;angular.module("app").service("DropdownService",t);i=function(){function n(){}return n.$inject=["$uibModal"],n}();n.AppModalService=i}(App||(App={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){"use strict";var e=function(){function n(){}return n}(),i,r,t,u,f;n.Entity=e;i=function(){function n(n){this.Name=n}return n}();n.PermissionRequest=i;r=function(){function n(){}return n}();n.Notification=r;t=function(){function n(){}return n.prototype.getBaseQueryString=function(){this.Page==null&&(this.Page=1);return"?keyword="+this.Keyword+"&orderBy="+this.OrderBy+"&page="+this.Page},n}();n.DataRequest=t;u=function(n){function t(t,i,r,u){n.call(this);this.Keyword=t;this.OrderBy=i;this.IsAscending=r;this.ParentId=u;this.Page=1}return __extends(t,n),t}(t);n.SearchRequest=u;f=function(n){function t(t){n.call(this);this.Id=t}return __extends(t,n),t.prototype.GetQueryString=function(){return"?id="+this.Id},t}(t);n.DetailRequest=f}(App||(App={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){"use strict";var t=function(){function n(n,t,i){this.IsSuccess=n;this.Data=t;this.Message=i==null?"Success":i}return n}(),i,r,u;n.BaseResponse=t;i=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(t);n.PermissionResponse=i;r=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(t);n.ErrorResponse=r;u=function(n){function t(t){n.call(this,!0,t,"Success");this.Models=t}return __extends(t,n),t}(t);n.SearchResponse=u}(App||(App={}));angular.module("app").service("authInterceptorService",["$q","$injector",function(n,t){var i={},r=function(n){var r=t.get("AuthService"),i;return n.headers=n.headers||{},i=r.AccountInfo,i&&(n.headers.Authorization="Bearer "+i.AccessToken,n.headers.Mama=(new Date).toDateString()),n},u=function(t){return t.status===401&&(console.log("permission rejection"),console.log(t)),n.reject(t)};return i.request=r,i.responseError=u,i}]);angular.module("app").config(["$httpProvider",function(n){n.interceptors.push("authInterceptorService")}]);angular.module("app").run(["AuthService",n=>{n.IsSignedIn(),n.FillAuthData()}]);angular.module("app").run(["$rootScope","$state","permissionService","AuthService",function(n,t,i,r){n.$on("$stateChangeStart",function(n,u){var f=u.name.replace("root.","");i.IsAllowed(f).then(function(i){i.IsAllowed||(n.preventDefault(),r.IsSignedIn()?t.go("root.denied"):t.go("root.signin"))},n=>{console.log(n),r.IsSignedIn()?t.go("root.denied"):t.go("root.signin")})})}]),function(n){var i=function(){function t(n,t,i,r){this.Q=n;this.Url=i;this.Web=r;this.localStorageService=t}return t.prototype.Signin=function(t){var i=this,r,u;return i.Signout(),r=i.Q.defer(),u="username="+t.Email+"&password="+t.Password+"&grant_type=password",i.Web.PostUrlencodedForm(i.Url.SigninUrl,u).then(function(t){i.AccountInfo=new n.AccountInfo;i.AccountInfo.UserName=t.data.userName;i.AccountInfo.RoleName=t.data.roleName;i.AccountInfo.AuthToken=t.data.AuthToken;i.AccountInfo.AccessToken=t.data.access_token;i.AccountInfo.IsAuth=!0;i.Web.Get(i.Url.SideMenuUrl).then(function(n){console.log(n);i.AccountInfo.Routes=n.data;r.resolve(i.AccountInfo)},function(n){console.log(n)})},function(n){r.reject(n)}),r.promise},t.prototype.Signout=function(){this.localStorageService.remove("authorizationData");this.AccountInfo=null},t.prototype.FillAuthData=function(){var n=this.localStorageService.get("authorizationData");n&&(this.AccountInfo=n)},t.prototype.IsSignedIn=function(){return this.AccountInfo==null?!1:this.AccountInfo.IsAuth},t.prototype.LoadMenu=function(){var n=this;n.Web.Get(n.Url.SideMenuUrl).then(function(t){console.log(t);n.AccountInfo.Routes=t.data},function(n){console.log(n)})},t.prototype.Register=function(t){var i=this,r;return i.Signout(),r=i.Q.defer(),i.Web.Post(i.Url.RegisterUrl,t).then(function(t){var i=new n.RegisterResponse(!0,t.data,"Success");i.UserName=t.data.userName;i.IsRegistered=!0;r.resolve(i)},function(n){r.reject(n)}),r.promise},t.$inject=["$q","localStorageService","UrlService","WebService"],t}(),t;n.AuthService=i;angular.module("app").service("AuthService",i);t=function(){function t(n,t,i){this.q=n;this.securityUrlService=t;this.web=i}return t.prototype.IsAllowed=function(t){var i=this,r=i.q.defer();return i.web.Post(i.securityUrlService.PermissionUrl,new n.PermissionRequest(t)).then(function(t){var i=new n.PermissionResponse(!0,t.data,"Success");i.IsAllowed=!0;r.resolve(i)},function(n){r.reject(n)}),r.promise},t.$inject=["$q","UrlService","WebService"],t}();n.PermissionService=t;angular.module("app").service("permissionService",t)}(App||(App={})),function(n){var u=function(){function n(n,t){this.Email=n;this.Password=t}return n}(),t,i,r;n.SigninRequest=u;t=function(){function n(n,t,i,r,u,f){this.Email=n;this.Password=t;this.ConfirmPassword=i;this.FirstName=r;this.LastName=u;this.Phone=f}return n}();n.RegisterRequest=t;i=function(){function n(){}return n}();n.AccountInfo=i;r=function(){function n(n,t,i){this.IsSuccess=n;this.data=t;this.Message=i==null?"Success":i}return n}();n.RegisterResponse=r}(App||(App={}));angular.module("app").directive("showtab",function(){return{link:function(n,t){t.click(function(n){n.preventDefault();$(t).tab("show")})}}});