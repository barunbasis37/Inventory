var App;(function(n){var t=function(){function n(n,t,i){this.IsSignedIn=!1;var r=this;r.authService=i;r.stateService=n;r.rootScopeService=t;r.rootScopeService.$on("SignedIn",function(){r.Activate()});r.rootScopeService.$on("SignedOut",function(){r.Activate();r.loadUser()});r.Activate()}return n.prototype.Activate=function(){var n=this,t=n.authService.AccountInfo;t&&t.IsAuth?n.loadUser():n.IsSignedIn=!1},n.prototype.loadUser=function(){var n=this;n.User=this.authService.AccountInfo;n.IsSignedIn=this.authService.IsSignedIn()},n.$inject=["$state","$rootScope","AuthService"],n}();n.HomeController=t;angular.module("app").controller("HomeController",t)})(App||(App={})),function(n){"use strict";var t=function(){function n(n,t,i,r){this.$location=n;this.IsSignedIn=!1;var u=this;u.authService=i;u.stateService=r;u.rootScopeService=t;u.rootScopeService.$on("SignedIn",function(){u.Activate()});u.rootScopeService.$on("SignedOut",function(){u.Activate();u.loadUser()});u.Activate()}return n.prototype.Activate=function(){var n=this,t=n.authService.AccountInfo;t&&t.IsAuth?(n.loadUser(),n.Routes=n.User.Routes):(n.IsSignedIn=!1,n.Routes=[])},n.prototype.LoadSideMenu=function(n){var i=this,t;if(i.Routes)for(t=0;t<i.Routes.length;t++)if(i.Routes[t]===n)return!0;return!1},n.prototype.loadUser=function(){var n=this;n.User=this.authService.AccountInfo;n.IsSignedIn=this.authService.IsSignedIn()},n.$inject=["$location","$rootScope","AuthService","$state"],n}();n.SideMenuController=t;angular.module("app").controller("SideMenuController",t)}(App||(App={})),function(n){"use strict";var t=function(){function t(n,t,i,r,u){this.$location=n;this.Url=t;this.SearchService=i;this.SaveService=r;this.authService=u;this.Activate();var f=this.authService.AccountInfo;f&&f.IsAuth&&this.loadUser()}return t.prototype.Activate=function(){this.Models=[];this.Model=new n.Product;this.ProductPriceViewModel=new n.ProductPriceViewModel;this.BarcodeUrl="";this.IsUpdateMode=!1;this.SearchRequest=new n.SearchRequest("","Modified","False","");this.SearchRequest.Page=1;this.Search()},t.prototype.loadUser=function(){var n=this;n.User=this.authService.AccountInfo},t.prototype.Search=function(){var t=this,u=function(i){t.Models=i.Models;t.ProductPriceViewModel=new n.ProductPriceViewModel;for(var r=0;r<t.Models.length;r++)t.ProductPriceViewModel.CostPriceTotal+=t.Models[r].CostPrice,t.ProductPriceViewModel.SalePriceTotal+=t.Models[r].SalePrice,t.ProductPriceViewModel.Total+=t.Models[r].OnHand*t.Models[r].CostPrice},f=function(n){console.log(n)},i,r;t.SearchService.Search(t.SearchRequest,t.Url.ProductQueryData).then(u,f);i=function(n){t.SearchRequest.TotalPage=Math.ceil(n.Data/10)};r=function(n){console.log(n)};t.SearchService.Search(t.SearchRequest,t.Url.ProductQueryCount).then(i,r)},t.prototype.Goto=function(n){this.SearchRequest.Page=n;this.Search()},t.prototype.Save=function(){var i=this,t=this,r=function(){t.Model=new n.Product;i.Search()},u=function(n){console.log(n)};t.SaveService.Save(t.Model,t.Url.Product).then(r,u)},t.prototype.Update=function(){var i=this,t=this,r=function(){t.IsUpdateMode=!1;t.Model=new n.Product;i.Search()},u=function(n){console.log(n);i.Search()};t.SaveService.Update(t.Model,t.Url.Product).then(r,u)},t.prototype.Edit=function(n){this.Model=n;this.IsUpdateMode=!0},t.prototype.Delete=function(t){var r=this,i=this,u=function(){i.IsUpdateMode=!1;i.Model=new n.Product;r.Search()},f=function(n){console.log(n);r.Search()};i.SaveService.Delete(t,i.Url.Product).then(u,f)},t.prototype.Generate=function(){var n=this,i=function(){n.BarcodeUrl="/BarcodeImages/"+n.Model.Id+".png"},r=function(n){console.log(n)},t=n.Url.BarcodeImage+"?id="+this.Model.Id;window.open(t,"_blank")},t.prototype.DeleteImage=function(){var n=this,t=function(){n.BarcodeUrl=null},i=function(n){console.log(n)};n.SaveService.Delete(n.Model.Id,n.Url.BarcodeImage).then(t,i)},t.prototype.GetBarcode=function(){var n=this,t=function(t){n.Model.BarCode=t},i=function(n){console.log(n)};n.SearchService.Get(n.Url.ProductQueryBarcode).then(t,i)},t.prototype.Report=function(){var n=this;window.open(n.Url.ProductQueryReport,"_blank","")},t.$inject=["$location","UrlService","SearchService","SaveService","AuthService"],t}();n.ProductsController=t;angular.module("app").controller("ProductsController",t)}(App||(App={})),function(n){var t=function(){function t(n,t,i){this.$location=n;this.Url=t;this.SearchService=i;this.Activate()}return t.prototype.Activate=function(){this.Models=[];this.SearchRequest=new n.SearchRequest("","Modified","False","");this.SearchRequest.Page=1;this.SearchRequest.MaxQuantity=10;this.Search();this.ProductPriceViewModel=new n.ProductPriceViewModel},t.prototype.Search=function(){var t=this,u=function(i){t.Models=i.Models;t.ProductPriceViewModel=new n.ProductPriceViewModel;for(var r=0;r<t.Models.length;r++)t.ProductPriceViewModel.CostPriceTotal+=t.Models[r].CostPrice,t.ProductPriceViewModel.SalePriceTotal+=t.Models[r].SalePrice,t.ProductPriceViewModel.Total+=t.Models[r].OnHand*t.Models[r].CostPrice},f=function(n){console.log(n)},i,r;t.SearchService.Search(t.SearchRequest,t.Url.ProductQueryData).then(u,f);i=function(n){t.SearchRequest.TotalPage=Math.ceil(n.Data/10)};r=function(n){console.log(n)};t.SearchService.Search(t.SearchRequest,t.Url.ProductQueryCount).then(i,r)},t.prototype.Goto=function(n){this.SearchRequest.Page=n;this.Search()},t.$inject=["$location","UrlService","SearchService","SaveService"],t}();n.StockoutReportController=t;angular.module("app").controller("StockoutReportController",t)}(App||(App={})),function(n){"use strict";var r=n.Bookmark,i=function(){function t(n,t,i,r,u,f,e){this.$location=n;this.Url=t;this.SearchService=i;this.SaveService=r;this.authService=u;this.stateService=f;this.stateParams=e;this.Activate();var o=this.authService.AccountInfo;o&&o.IsAuth&&this.loadUser()}return t.prototype.Activate=function(){this.IsUpdateMode=!1;this.Models=[];this.Model=new r;this.SearchRequest=new n.SearchRequest("","Modified","False","");this.CommandUrl=this.Url.Bookmark;this.QueryUrl=this.Url.BookmarkQueryData;this.Search()},t.prototype.loadUser=function(){var n=this;n.User=this.authService.AccountInfo},t.prototype.Search=function(){var n=this,r=function(t){console.log(t);n.Models=t.Models},u=function(n){console.log(n)},t,i;n.SearchService.Search(n.SearchRequest,n.QueryUrl).then(r,u);t=function(t){n.SearchRequest.TotalPage=Math.ceil(t.Data/10)};i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.BookmarkQueryCount).then(t,i)},t.prototype.Goto=function(n){this.SearchRequest.Page=n;this.Search()},t.prototype.Save=function(){var n=this,t=function(){n.Activate()},i=function(n){console.log(n)};n.SaveService.Save(n.Model,n.CommandUrl).then(t,i)},t.prototype.Update=function(){var n=this,t=function(){n.Activate()},i=function(n){console.log(n)};n.SaveService.Update(n.Model,n.CommandUrl).then(t,i)},t.prototype.Edit=function(n){this.Model=n;this.IsUpdateMode=!0},t.prototype.Delete=function(n){var t=this,i=function(){t.Activate()},r=function(n){console.log(n)};t.SaveService.Delete(n,t.CommandUrl).then(i,r)},t.prototype.History=function(n){var t=this;t.stateService.go("root.productbookmark",{bookmark:{Id:n.Id}})},t.$inject=["$location","UrlService","SearchService","SaveService","AuthService","$state","$stateParams"],t}(),t;n.BookmarkController=i;angular.module("app").controller("BookmarkController",i);t=function(){function t(n,t,i,r,u,f){this.$location=n;this.Url=t;this.SearchService=i;this.stateService=u;this.stateParams=f;this.SaveService=r;this.Activate()}return t.prototype.Activate=function(){this.Bookmark=new n.Bookmark;var t=this.stateParams.bookmark;t!=undefined?(this.Bookmark=t,this.SearchRequest=new n.SearchRequest("","Modified","False"),this.SearchRequest.ParentId=t.Id,this.SearchRequest.Page=1):(alert("Invalid parameter"),this.stateService.go("root.bookmarks"));this.Models=[];this.Model=new n.ProductBookmark;this.Model.BookmarkId=this.Bookmark.Id;this.IsUpdateMode=!1;this.Search()},t.prototype.Search=function(){var n=this,r=function(t){n.Models=t.Models},u=function(n){console.log(n)},t,i;n.SearchService.Search(n.SearchRequest,n.Url.ProductBookmarkQueryData).then(r,u);t=function(t){n.SearchRequest.TotalPage=Math.ceil(t.Data/10)};i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.ProductBookmarkQueryCount).then(t,i)},t.prototype.Goto=function(n){this.SearchRequest.Page=n;this.Search()},t.prototype.Save=function(){var i=this,t=this,r=function(){t.Model=new n.ProductBookmark;i.Search()},u=function(n){console.log(n)};t.SaveService.Save(t.Model,t.Url.ProductBookmark).then(r,u)},t.prototype.Update=function(){var i=this,t=this,r=function(){t.IsUpdateMode=!1;t.Model=new n.ProductBookmark;t.Model.BookmarkId=t.Bookmark.Id;i.Search()},u=function(n){console.log(n);i.Search()};t.SaveService.Update(t.Model,t.Url.ProductBookmark).then(r,u)},t.prototype.Edit=function(n){this.Model=n;this.IsUpdateMode=!0},t.prototype.Delete=function(t){var r=this,i=this,u=function(){i.IsUpdateMode=!1;i.Model=new n.ProductBookmark;r.Search()},f=function(n){console.log(n);r.Search()};i.SaveService.Delete(t,i.Url.ProductBookmark).then(u,f)},t.$inject=["$location","UrlService","SearchService","SaveService","$state","$stateParams"],t}();n.ProductBookmarkController=t;angular.module("app").controller("ProductBookmarkController",t)}(App||(App={})),function(n){var t=function(){function t(n,t,i,r){this.$location=n;this.Url=i;this.SearchService=r;this.modal=t;this.Activate()}return t.prototype.Activate=function(){this.Models=[];this.Model=new n.StockViewModel;this.SearchRequest=new n.SearchRequest("","Modified","False","");this.Search()},t.prototype.Search=function(){var n=this,r=function(t){console.log(t);n.Model=t.Data;n.Models=n.Model.StockDetailViewModels},u=function(n){console.log(n)},t,i;n.SearchService.Search(n.SearchRequest,n.Url.StockQueryData).then(r,u);t=function(t){n.SearchRequest.TotalPage=Math.ceil(t.Data/10)};i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.StockQueryCount).then(t,i)},t.prototype.Goto=function(n){this.SearchRequest.Page=n;this.Search()},t.prototype.UpdateDate=function(){var t=this.SearchRequest.Start,n;t&&(this.SearchRequest.StartDate=t.toDateString());n=this.SearchRequest.End;n&&(this.SearchRequest.EndDate=n.toDateString());console.log(this.SearchRequest)},t.$inject=["$location","$uibModal","UrlService","SearchService"],t}();n.StockReportController=t;angular.module("app").controller("StockReportController",t)}(App||(App={})),function(n){"use strict";var i=n.Supplier,t=function(){function t(n,t,i,r,u,f,e){this.$location=n;this.Url=t;this.SearchService=i;this.SaveService=r;this.authService=u;this.stateService=f;this.stateParams=e;this.Activate();var o=this.authService.AccountInfo;console.log(o);o&&o.IsAuth&&this.loadUser()}return t.prototype.Activate=function(){this.IsUpdateMode=!1;this.Models=[];this.Model=new i;this.TotalDue=0;this.SearchRequest=new n.SearchRequest("","Modified","False","");this.CommandUrl=this.Url.Supplier;this.QueryUrl=this.Url.SupplierQueryData;this.Search()},t.prototype.loadUser=function(){var n=this;n.User=this.authService.AccountInfo},t.prototype.Search=function(){var n=this,r=function(t){console.log(t);n.Models=t.Models;n.TotalDue=0;for(var i=0;i<n.Models.length;i++)n.TotalDue+=n.Models[i].Due},u=function(n){console.log(n)},t,i;n.SearchService.Search(n.SearchRequest,n.QueryUrl).then(r,u);t=function(t){n.SearchRequest.TotalPage=Math.ceil(t.Data/10)};i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.SupplierQueryCount).then(t,i)},t.prototype.Goto=function(n){this.SearchRequest.Page=n;this.Search()},t.prototype.Save=function(){var n=this,t=function(){n.Activate()},i=function(n){console.log(n)};n.SaveService.Save(n.Model,n.CommandUrl).then(t,i)},t.prototype.Update=function(){var n=this,t=function(){n.Activate()},i=function(n){console.log(n)};n.SaveService.Update(n.Model,n.CommandUrl).then(t,i)},t.prototype.Edit=function(n){this.Model=n;this.IsUpdateMode=!0},t.prototype.Delete=function(n){var t=this,i=function(){t.Activate()},r=function(n){console.log(n)};t.SaveService.Delete(n,t.CommandUrl).then(i,r)},t.prototype.History=function(n){var t=this;t.stateService.go("root.supplierhistory",{supplier:{Id:n.Id,Name:n.Name,Address:n.Address,Phone:n.Phone,Company:n.CompanyName}})},t.prototype.Report=function(){var n=this;window.open(n.Url.SupplierQueryReport,"_blank","")},t.$inject=["$location","UrlService","SearchService","SaveService","AuthService","$state","$stateParams"],t}();n.SuppliersController=t;angular.module("app").controller("SuppliersController",t)}(App||(App={})),function(n){var t=function(){function t(n,t,i,r,u,f,e){this.$location=n;this.Url=t;this.SearchService=i;this.stateService=f;this.stateParams=e;this.Dropdown={};this.DropdownService=u;this.Activate()}return t.prototype.Activate=function(){this.Model=new n.SupplierHistory;this.Supplier=new n.Supplier;var t=this.stateParams.supplier;t!=undefined?(this.Supplier=t,this.SearchRequest=new n.SearchRequest("","Modified","False"),this.SearchRequest.Id=t.Id):(alert("Invalid supplier"),this.stateService.go("root.suppliers"));this.QueryUrl=this.Url.SupplierHistoryQuery;this.Search()},t.prototype.Search=function(){var t=this,n=this,i=function(n){console.log(n);t.Model=n.Data},r=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.QueryUrl).then(i,r)},t.prototype.LoadDropdown=function(n){var t=this,i=function(i){console.log(i);t.Dropdown[n]=i.Models;console.log(t.Dropdown)},r=function(n){console.log(n)};t.DropdownService.Load(n).then(i,r)},t.$inject=["$location","UrlService","SearchService","SaveService","DropdownService","$state","$stateParams"],t}();n.SupplierHistoryController=t;angular.module("app").controller("SupplierHistoryController",t)}(App||(App={})),function(n){"use strict";var t=function(){function t(n,t,i,r,u,f,e,o){this.$location=n;this.Url=t;this.SearchService=i;this.SaveService=r;this.authService=u;this.DropdownService=f;this.IsUpdateMode=!1;this.stateService=e;this.stateParams=o;this.Activate();var s=this.authService.AccountInfo;s&&s.IsAuth&&this.loadUser()}return t.prototype.Activate=function(){console.log("i m in PurchasesController");this.Models=[];this.Dropdown={};this.Model=new n.Purchase;this.TotalPurchase=0;this.SearchRequest=new n.SearchRequest("","Modified","False","");this.Search();this.LoadDropdown("supplier")},t.prototype.loadUser=function(){var n=this;n.User=this.authService.AccountInfo},t.prototype.LoadDropdown=function(n){var t=this,i=function(i){console.log(i);t.Dropdown[n]=i.Models;console.log(t.Dropdown)},r=function(n){console.log(n)};t.DropdownService.Load(n).then(i,r)},t.prototype.Search=function(){var n=this,r=function(t){console.log(t);n.Models=t.Models;n.TotalPurchase=0;for(var i=0;i<n.Models.length;i++)n.TotalPurchase+=n.Models[i].Total},u=function(n){console.log(n)},t,i;n.SearchService.Search(n.SearchRequest,n.Url.PurchaseQueryData).then(r,u);t=function(t){n.SearchRequest.TotalPage=Math.ceil(t.Data/10)};i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.PurchaseQueryCount).then(t,i)},t.prototype.Goto=function(n){this.SearchRequest.Page=n;this.Search()},t.prototype.Save=function(){var i=this,t=this,r=function(r){console.log(r);t.Model=new n.Purchase;i.Search()},u=function(n){console.log(n)};t.SaveService.Save(t.Model,t.Url.Purchase).then(r,u)},t.prototype.Update=function(){var i=this,t=this,r=function(r){console.log(r);t.IsUpdateMode=!1;t.Model=new n.Purchase;i.Search()},u=function(n){console.log(n);i.Search()};t.SaveService.Update(t.Model,t.Url.Purchase).then(r,u)},t.prototype.Edit=function(n){this.Model=n;this.IsUpdateMode=!0},t.prototype.Delete=function(t){var r=this,i=this,u=function(t){console.log(t);i.IsUpdateMode=!1;i.Model=new n.Purchase;r.Search()},f=function(n){console.log(n);r.Search()};i.SaveService.Delete(t,i.Url.Purchase).then(u,f)},t.prototype.AddDetail=function(n){var t=this;t.stateService.go("root.purchasedetails",{purchase:{Id:n.Id,Memo:n.Memo,Total:n.Total}})},t.prototype.UpdateDate=function(){var t=this.SearchRequest.Start,n;t&&(this.SearchRequest.StartDate=t.toDateString());n=this.SearchRequest.End;n&&(this.SearchRequest.EndDate=n.toDateString());console.log(this.SearchRequest)},t.prototype.Report=function(){var n=this;window.open(n.Url.PurchaseQueryReport,"_blank","")},t.$inject=["$location","UrlService","SearchService","SaveService","AuthService","DropdownService","$state","$stateParams"],t}();n.PurchasesController=t;angular.module("app").controller("PurchasesController",t)}(App||(App={})),function(n){var t=function(){function t(n,t,i,r,u,f,e){this.$location=n;this.Url=t;this.SearchService=i;this.SaveService=r;this.stateService=f;this.stateParams=e;this.Dropdown={};this.DropdownService=u;this.Activate()}return t.prototype.Activate=function(){this.IsUpdateMode=!1;this.Models=[];this.Model=new n.PurchaseDetail;this.Products=[];this.Product=new n.Product;this.CommandUrl=this.Url.PurchaseDetail;this.QueryUrl=this.Url.PurchaseDetailQuery;var t=this.stateParams.purchase;t!=undefined?(this.Parent=t,this.Model.PurchaseId=t.Id,this.SearchRequest=new n.SearchRequest("","Modified","False",this.Model.PurchaseId)):(alert("Invalid purchase"),this.stateService.go("root.purchases"));this.Search();this.LoadDropdown("product");this.LoadDropdown("supplier")},t.prototype.Search=function(){var n=this,t=function(t){var i,r;for(console.log(t),n.Models=t.Models,n.Parent.Total=0,i=0;i<n.Models.length;i++)r=n.Models[i],n.Parent.Total+=parseFloat(r.Total)},i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.QueryUrl).then(t,i)},t.prototype.SearchProduct=function(){var n=this,t=function(t){console.log(t);n.Products=t.Models},i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.ProductQueryData).then(t,i)},t.prototype.Save=function(){var n=this,t=function(){n.Activate()},i=function(n){console.log(n)};n.SaveService.Save(n.Model,n.CommandUrl).then(t,i)},t.prototype.Update=function(){var n=this,t=function(){n.Activate()},i=function(n){console.log(n)};n.SaveService.Update(n.Model,n.CommandUrl).then(t,i)},t.prototype.Edit=function(n){this.Model=n;this.IsUpdateMode=!0},t.prototype.Delete=function(n){var t=this,i=function(){t.Activate()},r=function(n){console.log(n)};t.SaveService.Delete(n,t.CommandUrl).then(i,r)},t.prototype.LoadDropdown=function(n){var t=this,i=function(i){console.log(i);t.Dropdown[n]=i.Models;console.log(t.Dropdown)},r=function(n){console.log(n)};t.DropdownService.Load(n).then(i,r)},t.prototype.Select=function(n){console.log(n);this.Model.ProductId=n.Id;this.Product=n;this.Model.Price=n.CostPrice;console.log(this.Model)},t.$inject=["$location","UrlService","SearchService","SaveService","DropdownService","$state","$stateParams"],t}();n.PurchaseDetailsController=t;angular.module("app").controller("PurchaseDetailsController",t)}(App||(App={})),function(n){"use strict";var t=function(){function t(n,t,i,r,u,f){this.$location=n;this.Url=t;this.SearchService=i;this.SaveService=r;this.authService=u;this.DropdownService=f;this.IsUpdateMode=!1;this.Activate();var e=this.authService.AccountInfo;e&&e.IsAuth&&this.loadUser()}return t.prototype.Activate=function(){console.log("i m in PaymentsController");this.Models=[];this.Model=new n.Payment;this.TotalAmount=0;this.Dropdown={};this.SearchRequest=new n.SearchRequest("","Modified","False","");this.Search();this.LoadDropdown("supplier")},t.prototype.loadUser=function(){var n=this;n.User=this.authService.AccountInfo},t.prototype.LoadDropdown=function(n){var t=this,i=function(i){console.log(i);t.Dropdown[n]=i.Models;console.log(t.Dropdown)},r=function(n){console.log(n)};t.DropdownService.Load(n).then(i,r)},t.prototype.Search=function(){var n=this,r=function(t){console.log(t);n.Models=t.Models;n.TotalAmount=0;for(var i=0;i<n.Models.length;i++)n.TotalAmount+=n.Models[i].Amount},u=function(n){console.log(n)},t,i;n.SearchService.Search(n.SearchRequest,n.Url.PaymentQueryData).then(r,u);t=function(t){n.SearchRequest.TotalPage=Math.ceil(t.Data/10)};i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.PaymentQueryCount).then(t,i)},t.prototype.Goto=function(n){this.SearchRequest.Page=n;this.Search()},t.prototype.Save=function(){var i=this,t=this,r=function(r){console.log(r);t.Model=new n.Payment;i.Search()},u=function(n){console.log(n)};t.SaveService.Save(t.Model,t.Url.Payment).then(r,u)},t.prototype.Update=function(){var i=this,t=this,r=function(r){console.log(r);t.IsUpdateMode=!1;t.Model=new n.Payment;i.Search()},u=function(n){console.log(n);i.Search()};t.SaveService.Update(t.Model,t.Url.Payment).then(r,u)},t.prototype.Edit=function(n){this.Model=n;this.IsUpdateMode=!0},t.prototype.Delete=function(t){var r=this,i=this,u=function(t){console.log(t);i.IsUpdateMode=!1;i.Model=new n.Payment;r.Search()},f=function(n){console.log(n);r.Search()};i.SaveService.Delete(t,i.Url.Payment).then(u,f)},t.prototype.UpdateDate=function(){var t=this.SearchRequest.Start,n;t&&(this.SearchRequest.StartDate=t.toDateString());n=this.SearchRequest.End;n&&(this.SearchRequest.EndDate=n.toDateString());console.log(this.SearchRequest)},t.prototype.Report=function(){var n=this;window.open(n.Url.PaymentQueryReport,"_blank","")},t.$inject=["$location","UrlService","SearchService","SaveService","AuthService","DropdownService"],t}();n.PaymentsController=t;angular.module("app").controller("PaymentsController",t)}(App||(App={}));angular.module("app").controller("ModalInstanceCtrl",["$scope","$uibModalInstance","sale",function(n,t,i){function u(){n.sale=i}function r(n){var i=document.getElementById(n).innerHTML,t;return navigator.userAgent.toLowerCase().indexOf("chrome")>-1?(t=window.open("","_blank","width=400,height=600,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no"),t.window.focus(),t.document.write('<!DOCTYPE html><html><head><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous"><\/head><body onload="window.print()"><div style="width: auto; height:auto;">'+i+"<\/div><\/html>"),t.onbeforeunload=function(){t.close()},t.onabort=function(){t.document.close();t.close()}):(t=window.open("","_blank","width=750,height=600"),t.document.open(),t.document.write('<html><head><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous"><\/head><body onload="window.print()">'+i+"<\/html>"),t.document.close()),!0}u();n.Ok=function(){t.close(i);n.Print()};n.Cancel=function(){t.dismiss("cancel")};n.Print=function(){r("receipt")}}]),function(n){"use strict";var t=function(){function t(n,t,i,r,u,f){var e=this;this.$location=n;this.productExistsInCart=function(n){return e.Cart.Products.filter(function(t){return t.Product.Name===n.Name}).length>0};this.Url=i;this.SearchService=r;this.SaveService=u;this.AuthService=f;this.modal=t;this.Activate()}return t.prototype.Activate=function(){console.log("i m in SalesController");this.Models=[];this.Model=new n.Product;this.ProductCartModel=new n.ProductCartModel(this.Model,1);this.CustomerModels=[];this.CustomerModel=new n.Customer;this.Cart=new n.CartViewModel;this.IsUpdateMode=!1;this.SearchRequest=new n.SearchRequest("","Modified","False","")},t.prototype.Search=function(){var n=this,t=function(t){console.log(t);n.Models=t.Models},i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.ProductQueryData).then(t,i)},t.prototype.Detail=function(n){this.Model=n},t.prototype.Edit=function(n){this.Model=n.Product;this.ProductCartModel.Quantity=n.Quantity},t.prototype.AddToCart=function(t,i){t.Name?(this.productExistsInCart(t)?this.Cart.Products.filter(function(n){return n.Product.Name===t.Name})[0].Quantity=i:this.Cart.Products.push(new n.ProductCartModel(t,i)),this.updateCartTotal(),this.Model=new n.Product,this.ProductCartModel=new n.ProductCartModel(this.Model,1)):alert("Select a product first.")},t.prototype.RemoveFromCart=function(n){var t=this.Cart.Products.filter(function(t){return t.Product.Name===n.Name})[0],i=this.Cart.Products.indexOf(t);this.Cart.Products.splice(i,1);this.updateCartTotal()},t.prototype.updateCartTotal=function(){var t=this,n=this;n.Cart.ItemTotal=0;n.Cart.Products.forEach(function(n){return t.Cart.ItemTotal+=n.Total()});console.log(n.Cart)},t.prototype.GetReturn=function(){var n=this;n.Cart.Return=0;n.Cart.Return=n.Cart.Paid-n.Cart.Total},t.prototype.ApplyDiscount=function(){var n=this;n.Cart.Total=n.Cart.ItemTotal-n.Cart.Discount},t.prototype.Save=function(){var u=this,i=this,o=function(){i.Activate()},s=function(n){console.log(n);alert("Couldnt save the sale. Error occurred.")},t=new n.Sale,r,f,e;for(t.SaleType=i.Cart.SaleType,t.TrxNo=i.Cart.Card!=undefined?i.Cart.Card+" - "+i.Cart.TrxNo:"N/A",t.CardName=i.Cart.Card!=undefined?i.Cart.Card:"N/A",t.Total=i.Cart.Total,t.Paid=i.Cart.Paid,t.Return=i.Cart.Return,t.Remarks=i.Cart.Remarks,t.Memo=i.Cart.Memo,t.ItemTotal=i.Cart.ItemTotal,t.Discount=i.Cart.Discount,t.CustomerId=i.CustomerModel.Id,t.PointsEarned=0,t.PointsPaid=0,i.Cart.Products.forEach(function(r){var u=new n.SaleDetail;u.Quantity=r.Quantity;u.Price=r.Product.SalePrice;u.CostTotal=r.Product.CostPrice*r.Quantity;u.Total=r.Total();u.ProductId=r.Product.Id;u.ProductName=r.Product.Name;u.Created=(new Date).toDateString();u.Modified=(new Date).toDateString();u.CreatedBy=i.AuthService.AccountInfo.UserName;u.ModifiedBy=i.AuthService.AccountInfo.UserName;t.SaleDetails.push(u)}),t.CostTotal=0,r=0;r<t.SaleDetails.length;r++)t.CostTotal+=t.SaleDetails[r].CostTotal;f=this.modal;e=f.open({templateUrl:i.Url.BaseUrl+"/partials/sale/receipt.tpl.html",controller:"ModalInstanceCtrl",windowClass:"app-modal-window",size:"lg",resolve:{sale:t}});e.result.then(function(n){console.log(n);u.SaveService.Save(t,u.Url.Sale).then(o,s)},function(n){console.log(n)})},t.prototype.CustomerSearch=function(){var n=this,t=function(t){console.log(t);n.CustomerModels=t.Models},i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.CustomerQueryData).then(t,i)},t.prototype.CustomerDetail=function(n){this.CustomerModel=n},t.prototype.SetAnnonymous=function(){this.CustomerModel=new n.Customer},t.$inject=["$location","$uibModal","UrlService","SearchService","SaveService","AuthService"],t}();n.SalesController=t;angular.module("app").controller("SalesController",t)}(App||(App={})),function(n){var t=function(){function t(n,t,i,r,u,f){this.$location=n;this.Url=i;this.SearchService=r;this.modal=t;this.stateService=u;this.stateParams=f;this.Activate()}return t.prototype.Activate=function(){this.Models=[];this.Model=new n.SaleReport;this.SearchRequest=new n.SearchRequest("","Modified","False","");this.Search()},t.prototype.Search=function(){var t=this,u=function(i){console.log(i);t.Models=i.Models;t.Model=new n.SaleReport;for(var r=0;r<t.Models.length;r++)t.Models[r].SaleType==="Cash"?t.Model.CashTotal+=t.Models[r].Total:t.Model.CardTotal+=t.Models[r].Total,t.Model.ItemTotal+=t.Models[r].ItemTotal,t.Model.DiscountTotal+=t.Models[r].Discount,t.Model.Total+=t.Models[r].Total,t.Model.CostPrice+=t.Models[r].CostPrice},f=function(n){console.log(n)},i,r;t.SearchService.Search(t.SearchRequest,t.Url.SaleQueryData).then(u,f);i=function(n){t.SearchRequest.TotalPage=Math.ceil(n.Data/10)};r=function(n){console.log(n)};t.SearchService.Search(t.SearchRequest,t.Url.SaleQueryCount).then(i,r)},t.prototype.Goto=function(n){this.SearchRequest.Page=n;this.Search()},t.prototype.AddDetail=function(n){var t=this;t.stateService.go("root.saledetails",{sale:{Id:n.Id,Memo:n.Memo,Total:n.Total}})},t.prototype.UpdateDate=function(){var t=this.SearchRequest.Start,n;t&&(this.SearchRequest.StartDate=t.toDateString());n=this.SearchRequest.End;n&&(this.SearchRequest.EndDate=n.toDateString());console.log(this.SearchRequest)},t.prototype.Report=function(){var n=this;window.open(n.Url.SaleQueryReport,"_blank","")},t.$inject=["$location","$uibModal","UrlService","SearchService","$state","$stateParams"],t}();n.SalesReportController=t;angular.module("app").controller("SalesReportController",t)}(App||(App={})),function(n){var t=function(){function t(n,t,i,r,u,f,e){this.$location=n;this.Url=t;this.SearchService=i;this.SaveService=r;this.stateService=f;this.stateParams=e;this.Dropdown={};this.DropdownService=u;this.Activate()}return t.prototype.Activate=function(){this.IsUpdateMode=!1;this.Models=[];this.Model=new n.SaleDetail;this.Products=[];this.Product=new n.Product;this.CommandUrl=this.Url.SaleDetail;this.QueryUrl=this.Url.SaleDetailQuery;var t=this.stateParams.sale;t!=undefined?(this.Parent=t,this.Model.SaleId=t.Id,this.SearchRequest=new n.SearchRequest("","Modified","False",this.Model.SaleId)):(alert("Invalid selection"),this.stateService.go("root.sales-report"));this.Search()},t.prototype.Search=function(){var n=this,t=function(t){var i,r;for(console.log(t),n.Models=t.Models,n.Parent.Total=0,i=0;i<n.Models.length;i++)r=n.Models[i],n.Parent.Total+=parseFloat(r.Total)},i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.QueryUrl).then(t,i)},t.prototype.SearchProduct=function(){var n=this,t=function(t){console.log(t);n.Products=t.Models},i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.ProductQueryData).then(t,i)},t.prototype.Save=function(){var n=this,t=function(){n.Activate()},i=function(n){console.log(n)};n.SaveService.Save(n.Model,n.CommandUrl).then(t,i)},t.prototype.Update=function(){var n=this,t=function(){n.Activate()},i=function(n){console.log(n)};n.SaveService.Update(n.Model,n.CommandUrl).then(t,i)},t.prototype.Edit=function(n){this.Model=n;this.IsUpdateMode=!0},t.prototype.Delete=function(n){var t=this,i=function(){t.Activate()},r=function(n){console.log(n)};t.SaveService.Delete(n,t.CommandUrl).then(i,r)},t.prototype.LoadDropdown=function(n){var t=this,i=function(i){console.log(i);t.Dropdown[n]=i.Models;console.log(t.Dropdown)},r=function(n){console.log(n)};t.DropdownService.Load(n).then(i,r)},t.prototype.Select=function(n){console.log(n);this.Model.ProductId=n.Id;this.Product=n;this.Model.Price=n.CostPrice;console.log(this.Model)},t.$inject=["$location","UrlService","SearchService","SaveService","DropdownService","$state","$stateParams"],t}();n.SaleDetailsController=t;angular.module("app").controller("SaleDetailsController",t)}(App||(App={})),function(n){var t=function(){function t(n,t,i,r){this.$location=n;this.Url=t;this.SearchService=i;this.SaveService=r;this.Activate()}return t.prototype.Activate=function(){this.User=new n.UserInfoViewModel;this.ChangePasswordModel=new n.ChangePasswordModel;this.GetUserInfo()},t.prototype.GetUserInfo=function(){var n=this,t=function(t){console.log(t);n.User=t},i=function(n){console.log(n)};n.SearchService.Get(n.Url.ProfileUrl).then(t,i)},t.prototype.Update=function(){var n=this,t=function(){n.Activate();alert("Password changed successfully.")},i=function(n){console.log(n)};n.SaveService.Save(n.ChangePasswordModel,n.Url.ChangePasswordUrl).then(t,i)},t.$inject=["$location","UrlService","SearchService","SaveService"],t}();n.ProfileController=t;angular.module("app").controller("ProfileController",t)}(App||(App={})),function(n){"use strict";var i=n.Customer,t=function(){function t(n,t,i,r,u,f,e){this.$location=n;this.Url=t;this.SearchService=i;this.SaveService=r;this.authService=u;this.stateService=f;this.stateParams=e;this.Activate();var o=this.authService.AccountInfo;console.log(o);o&&o.IsAuth&&this.loadUser()}return t.prototype.Activate=function(){this.IsUpdateMode=!1;this.Models=[];this.Model=new i;this.TotalDue=0;this.SearchRequest=new n.SearchRequest("","Modified","False","");this.CommandUrl=this.Url.Customer;this.QueryUrl=this.Url.CustomerQueryData;this.Search()},t.prototype.loadUser=function(){var n=this;n.User=this.authService.AccountInfo},t.prototype.Search=function(){var n=this,r=function(t){n.Models=t.Models;n.TotalDue=0;for(var i=0;i<n.Models.length;i++)n.TotalDue+=n.Models[i].Point},u=function(n){console.log(n)},t,i;n.SearchService.Search(n.SearchRequest,n.QueryUrl).then(r,u);t=function(t){n.SearchRequest.TotalPage=Math.ceil(t.Data/10)};i=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.Url.CustomerQueryCount).then(t,i)},t.prototype.Goto=function(n){this.SearchRequest.Page=n;this.Search()},t.prototype.Save=function(){var n=this,t=function(){n.Activate()},i=function(n){console.log(n);alert("Could not save customer info. Please check the values carefully.")};n.SaveService.Save(n.Model,n.CommandUrl).then(t,i)},t.prototype.Update=function(){var n=this,t=function(){n.Activate()},i=function(n){console.log(n)};n.SaveService.Update(n.Model,n.CommandUrl).then(t,i)},t.prototype.Edit=function(n){this.Model=n;this.IsUpdateMode=!0},t.prototype.Delete=function(n){var t=this,i=function(){t.Activate()},r=function(n){console.log(n)};t.SaveService.Delete(n,t.CommandUrl).then(i,r)},t.prototype.History=function(n){var t=this;t.stateService.go("root.customerhistory",{customer:{Id:n.Id,Name:n.Name,Address:n.Address,Phone:n.Phone,MembarshipCardNo:n.MembarshipCardNo}})},t.prototype.Report=function(){var n=this;window.open(n.Url.CustomerQueryReport,"_blank","")},t.prototype.GetBarcode=function(){var n=this,t=function(t){n.Model.MembarshipCardNo=t},i=function(n){console.log(n)};n.SearchService.Get(n.Url.CustomerQueryBarcode).then(t,i)},t.$inject=["$location","UrlService","SearchService","SaveService","AuthService","$state","$stateParams"],t}();n.CustomersController=t;angular.module("app").controller("CustomersController",t)}(App||(App={})),function(n){var t=function(){function t(n,t,i,r,u,f,e){this.$location=n;this.Url=t;this.SearchService=i;this.stateService=f;this.stateParams=e;this.Dropdown={};this.DropdownService=u;this.Activate()}return t.prototype.Activate=function(){this.Model=new n.CustomerHistory;this.Customer=new n.Customer;var t=this.stateParams.customer;t!=undefined?(this.Customer=t,this.SearchRequest=new n.SearchRequest("","Modified","False"),this.SearchRequest.Id=t.Id):(alert("Invalid customer"),this.stateService.go("root.customers"));this.QueryUrl=this.Url.CustomerHistoryQuery;this.Search()},t.prototype.Search=function(){var t=this,n=this,i=function(n){console.log(n);t.Model=n.Data},r=function(n){console.log(n)};n.SearchService.Search(n.SearchRequest,n.QueryUrl).then(i,r)},t.prototype.LoadDropdown=function(n){var t=this,i=function(i){console.log(i);t.Dropdown[n]=i.Models;console.log(t.Dropdown)},r=function(n){console.log(n)};t.DropdownService.Load(n).then(i,r)},t.$inject=["$location","UrlService","SearchService","SaveService","DropdownService","$state","$stateParams"],t}();n.CustomerHistoryController=t;angular.module("app").controller("CustomerHistoryController",t)}(App||(App={}));